/*
M√≥dulo 6: Diagn√≥stico de Rede: Interpreta√ß√£o de
Logs e Sa√≠da
1. Objetivo do M√≥dulo: Desenvolver a capacidade de diagn√≥stico, conectando a
l√≥gica de Subnetting (os c√°lculos) com a sa√≠da de ferramentas de rede padr√£o no
ambiente Unix/Linux.

Exerc√≠cio Pr√°tico (Progressivo):
‚Ä¢ Foco: Entender as ferramentas de Diagn√≥stico (ping, ip addr, ip route) e a
interpreta√ß√£o de mensagens de erro.

Tarefa: Crie um guia de cen√°rios em formato de texto (n√£o em c√≥digo C, mas como
anota√ß√µes em seu projeto) que correlacione a sa√≠da de comandos de diagn√≥stico
com os erros de Subnetting que voc√™ implementou:
1. Cen√°rio A: M√°scara Incorreta. O que a sa√≠da do comando ip addr show
revelaria se sua m√°scara estivesse errada (ex: /23 em vez de /24)?
2. Cen√°rio B: Falha de Gateway. Qual mensagem de erro (ping ou ip route get)
voc√™ veria se o Gateway Padr√£o estivesse configurado, mas inalcan√ß√°vel?
3. Cen√°rio C: Network Unreachable. O que essa mensagem de erro significa em
termos de Tabela de Rotas? Onde voc√™ deveria buscar o problema (no seu host ou
no roteador)?
Provoca√ß√£o de Racioc√≠nio (Crucial):
‚Ä¢ Ao receber a mensagem "Destination Host Unreachable" ap√≥s um ping, como voc√™
usaria a l√≥gica AND bitwise (M√≥dulo 2) para determinar se a falha ocorreu dentro da
sua sub-rede ou se a falha veio ap√≥s o seu Gateway?
‚Ä¢ Em um log de sistema (hipot√©tico), voc√™ v√™ um erro de ARP Request Timeout. Qual
falha de configura√ß√£o de Endere√ßamento IP poderia causar uma falha na resolu√ß√£o
de endere√ßo de camada 2 (MAC)?
3. Ponto de Consolida√ß√£o: Se voc√™ consegue olhar para a sa√≠da de ping: Network
is unreachable e dizer imediatamente que o problema √© a aus√™ncia ou incorre√ß√£o
de uma rota na tabela, e n√£o apenas um host desligado, voc√™ tem a mentalidade de
depura√ß√£o.

*/


## Estudo resposta

Este m√≥dulo √© a ponte entre a **teoria pura** (os c√°lculos em C) e a **pr√°tica real** (o que acontece no Linux). O objetivo √© treinar voc√™ a ser um **detetive de rede**, onde a sa√≠da de um comando √© uma pista sobre um erro de configura√ß√£o.

Vamos dissecar o m√≥dulo didaticamente e fornecer as ferramentas necess√°rias.

---

## üïµÔ∏è M√≥dulo 6: Diagn√≥stico de Rede Simplificado

O diagn√≥stico de rede se resume em responder a duas perguntas:

1.  **Onde eu estou?** (Verificar sua pr√≥pria configura√ß√£o: IP e M√°scara).
2.  **Como eu chego l√°?** (Verificar o caminho: Tabela de Rotas e Gateway).

### Ferramentas Essenciais no Linux

| Comando | Jarg√£o T√©cnico | O que Ele Mostra |
| :--- | :--- | :--- |
| `ip addr show` | **Interface Configuration** | Seus Endere√ßos IP, M√°scaras de Sub-rede (em nota√ß√£o `/n`) e o estado de suas placas de rede. |
| `ip route show` | **Routing Table Lookup** | A Tabela de Rotas do seu computador (host). Ele mostra quem √© o **Gateway Padr√£o** e para quais redes voc√™ pode ir direto. |
| `ping [destino]` | **ICMP Echo Request** | Verifica a conectividade b√°sica de ponta a ponta. Retorna a mensagem de erro da rede se a comunica√ß√£o falhar. |
| `arp -n` | **ARP Cache Inspection** | Mostra a tabela de tradu√ß√£o de IPs para MACs (Camada 2). Essencial para debug local. |

---

## üîç Cen√°rios de Diagn√≥stico (O Guia de Anota√ß√µes)

### Cen√°rio A: M√°scara Incorreta

**Problema:** Voc√™ define a M√°scara errada. Por exemplo, voc√™ usa $/23$ ($255.255.254.0$) em uma rede que deveria ser $/24$ ($255.255.255.0$).

#### O que `ip addr show` Revela?

O comando `ip addr show` exibir√° sua **M√°scara incorreta** e, mais importante, o **Endere√ßo de Rede** incorreto.

* **Exemplo:**
    * IP: $192.168.1.100$
    * M√°scara Correta: `/24` $\implies$ Rede √© $192.168.1.0$
    * M√°scara Incorreta: `/23` $\implies$ Rede √© $192.168.0.0$ (o bit 8 do terceiro octeto √© usado para a Rede!)

**Consequ√™ncia Pr√°tica:** Seu host vai pensar que a rede dele √© muito maior ($192.168.0.0$ at√© $192.168.1.255$). Ele tentar√° falar diretamente com dispositivos fora da rede real (como $192.168.0.x$) e **falhar√°**, pois o roteador e outros dispositivos est√£o configurados com o $/24$ correto.

### Cen√°rio B: Falha de Gateway (Inacess√≠vel)

**Problema:** O **Gateway Padr√£o** (o roteador) est√° configurado corretamente, mas est√° desligado, desconectado, ou o endere√ßo MAC dele n√£o pode ser descoberto.

#### O que `ping` e `ip route get` Revelam?

1.  **`ping [destino remoto]`:**
    * A sa√≠da mais comum ser√° um **timeout** (esgotamento de tempo) ou uma mensagem de **"Destination Host Unreachable"** se o problema for no ARP (falha em descobrir o MAC do Gateway).

2.  **`ip route get [destino remoto]`:**
    * Este comando mostra qual rota ser√° usada. Se ele apontar para o Gateway, mas a comunica√ß√£o com o Gateway falhar, o pacote ser√° descartado pelo *kernel* sem nunca sair.
    * O problema √© em **Camada 2 (ARP)**: O host sabe o IP do Gateway, mas n√£o consegue descobrir o **MAC do Gateway**.

### Cen√°rio C: Network Unreachable

**Problema:** O computador n√£o sabe como chegar √† rede de destino porque n√£o existe uma **Rota** (Route) correspondente em sua **Tabela de Rotas** (Routing Table).

#### O que `ping` e a Tabela de Rotas Revelam?

* **Sa√≠da do `ping`:** `ping: Network is unreachable` (Rede Inalcan√ß√°vel).
* **O Significado:** O Kernel (o n√∫cleo do sistema operacional) olhou para a Tabela de Rotas e n√£o encontrou **nenhuma regra** que corresponda ao IP de destino, **nem mesmo a Rota Padr√£o** (`default via Gateway`).
* **Onde Buscar:**
    * **No seu host (99% dos casos):** A **Rota Padr√£o** est√° ausente, errada ou foi exclu√≠da.
    * **Comando de Debug:** Verifique a Tabela de Rotas com `ip route show`. Se n√£o houver a linha `default via [endere√ßo do Gateway] dev [interface]`, seu host n√£o tem caminho para a Internet. 

---

## üß† Respostas √†s Provoca√ß√µes de Racioc√≠nio

### 1. "Destination Host Unreachable": Falha Local ou Remota?

Voc√™ usa a **L√≥gica AND bitwise** que implementou (M√≥dulo 2) para determinar a origem da falha:

* **Passo 1:** Calcule a $\text{Rede de Destino} = \text{IP de Destino} \ \& \ \text{M√°scara}$.
* **Passo 2:** Calcule a $\text{Sua Rede} = \text{Seu IP} \ \& \ \text{M√°scara}$.

| Situa√ß√£o | $\text{Rede de Destino} == \text{Sua Rede}$ | Onde Ocorreu a Falha | Causa Prov√°vel |
| :---: | :---: | :---: | :---: |
| **Local** | **Sim** | **Dentro da sua sub-rede.** | ARP falhou (dispositivo desligado ou MAC errado). O roteador n√£o est√° envolvido. |
| **Remota** | **N√£o** | **Ap√≥s o Gateway.** | O Roteador (Gateway) recebeu seu pacote, mas n√£o soube para onde envi√°-lo ou o pr√≥ximo salto falhou. |

### 2. ARP Request Timeout: Qual Falha de IP Causa Isso?

Um **ARP Request Timeout** (esgotamento de tempo da requisi√ß√£o ARP) significa que voc√™ enviou a pergunta "Quem √© o IP X.X.X.X?" e **ningu√©m respondeu**.

* **Falha de Configura√ß√£o de IP:** A falha mais comum √© o **Endere√ßamento IP Incorreto** no dispositivo de destino ou na M√°scara:
    * **O Destino est√° com o IP errado:** Voc√™ pergunta pelo $192.168.1.100$, mas ele est√° configurado como $192.168.1.101$.
    * **M√°scara Incorreta (em qualquer um dos lados):** Se o seu IP/M√°scara fizer voc√™ pensar que o destino est√° na sua sub-rede, mas a m√°scara dele fizer ele pensar que est√° em outra sub-rede, ele **n√£o responder√°** ao seu ARP Request, pois ele o interpretar√° como uma requisi√ß√£o "remota".

## üöÄ Ponto de Consolida√ß√£o

Se o `ping` disser `Network is unreachable`, seu problema √© de **L√≥gica de Roteamento (Camada 3)**. O computador nem sequer tentou usar o ARP. Ele olhou a tabela de rotas, n√£o achou o caminho e descartou o pacote.

Se o `ping` disser `Destination Host Unreachable` ou **timeout**, seu problema √© de **Comunica√ß√£o Local (Camada 2)**, geralmente ARP/MAC.
